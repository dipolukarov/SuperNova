(function(s,w,j,a){s.ion=s.ion||{};if(!ion.sound){var o=function(d){d||(d="undefined");if(s.console){console.warn&&"function"===typeof console.warn?console.warn(d):console.log&&"function"===typeof console.log&&console.log(d);var e=j&&j("#debug");if(e&&e.length){var c=e.html();e.html(c+d+"<br/>")}}},v=function(e,d){var f;d=d||{};for(f in e){e.hasOwnProperty(f)&&(d[f]=e[f])}return d};if("function"!==typeof Audio&&"object"!==typeof Audio){w=function(){o("HTML5 Audio is not supported in this browser")},ion.sound=w,ion.sound.play=w,ion.sound.stop=w,ion.sound.pause=w,ion.sound.preload=w,ion.sound.destroy=w,w()}else{w=/iPad|iPhone|iPod/.test(w.appVersion);var g=0,y={},x={},z;!y.supported&&w?y.supported=["mp3","mp4","aac"]:y.supported||(y.supported=["mp3","ogg","mp4","aac","wav"]);ion.sound=function(b){v(b,y);y.path=y.path||"";y.volume=y.volume||1;y.preload=y.preload||!1;y.multiplay=y.multiplay||!1;y.loop=y.loop||!1;y.sprite=y.sprite||null;y.scope=y.scope||null;y.ready_callback=y.ready_callback||null;y.ended_callback=y.ended_callback||null;if(g=y.sounds.length){for(z=0;z<g;z++){b=y.sounds[z];var c=b.alias||b.name;x[c]||(x[c]=new i(b),x[c].init())}}else{o("No sound-files provided!")}};ion.sound.VERSION="3.0.7";ion.sound._method=function(b,f,d){if(f){x[f]&&x[f][b](d)}else{for(z in x){if(x.hasOwnProperty(z)&&x[z]){x[z][b](d)}}}};ion.sound.preload=function(d,c){c=c||{};v({preload:!0},c);ion.sound._method("init",d,c)};ion.sound.destroy=function(b){ion.sound._method("destroy",b);if(b){x[b]=null}else{for(z in x){x.hasOwnProperty(z)&&x[z]&&(x[z]=null)}}};ion.sound.play=function(d,c){ion.sound._method("play",d,c)};ion.sound.stop=function(d,c){ion.sound._method("stop",d,c)};ion.sound.pause=function(d,c){ion.sound._method("pause",d,c)};ion.sound.volume=function(d,c){ion.sound._method("volume",d,c)};j&&(j.ionSound=ion.sound);w=s.AudioContext||s.webkitAudioContext;var u;w&&(u=new w);var i=function(b){this.options=v(y);delete this.options.sounds;v(b,this.options);this.request=null;this.streams={};this.result={};this.ext=0;this.url="";this.autoplay=this.no_file=this.decoded=this.loaded=!1};i.prototype={init:function(b){b&&v(b,this.options);this.options.preload&&this.load()},destroy:function(){var b;for(z in this.streams){(b=this.streams[z])&&b.destroy()}this.streams={};this.result=null;this.options=this.options.buffer=null;this.request&&(this.request.removeEventListener("load",this.ready.bind(this),!1),this.request.removeEventListener("error",this.error.bind(this),!1),this.request.abort(),this.request=null)},createUrl:function(){var b=(new Date).valueOf();this.url=this.options.path+encodeURIComponent(this.options.name)+"."+this.options.supported[this.ext]+"?"+b},load:function(){this.no_file?o('No sources for "'+this.options.name+'" sound :('):this.request||(this.createUrl(),this.request=new XMLHttpRequest,this.request.open("GET",this.url,!0),this.request.responseType="arraybuffer",this.request.addEventListener("load",this.ready.bind(this),!1),this.request.addEventListener("error",this.error.bind(this),!1),this.request.send())},reload:function(){this.ext++;this.options.supported[this.ext]?this.load():(this.no_file=!0,o('No sources for "'+this.options.name+'" sound :('))},ready:function(b){this.result=b.target;4!==this.result.readyState?this.reload():200!==this.result.status&&0!==this.result.status?(o(this.url+" was not found on server!"),this.reload()):(this.request.removeEventListener("load",this.ready.bind(this),!1),this.request.removeEventListener("error",this.error.bind(this),!1),this.request=null,this.loaded=!0,this.decode())},decode:function(){u&&u.decodeAudioData(this.result.response,this.setBuffer.bind(this),this.error.bind(this))},setBuffer:function(b){this.options.buffer=b;this.decoded=!0;b={name:this.options.name,alias:this.options.alias,ext:this.options.supported[this.ext],duration:this.options.buffer.duration};this.options.ready_callback&&"function"===typeof this.options.ready_callback&&this.options.ready_callback.call(this.options.scope,b);if(this.options.sprite){for(z in this.options.sprite){this.options.start=this.options.sprite[z][0],this.options.end=this.options.sprite[z][1],this.streams[z]=new t(this.options,z)}}else{this.streams[0]=new t(this.options)}this.autoplay&&(this.autoplay=!1,this.play())},error:function(){this.reload()},play:function(b){delete this.options.part;b&&v(b,this.options);if(!this.loaded){this.autoplay=!0,this.load()}else{if(!this.no_file&&this.decoded){if(this.options.sprite){if(this.options.part){this.streams[this.options.part].play(this.options)}else{for(z in this.options.sprite){this.streams[z].play(this.options)}}}else{this.streams[0].play(this.options)}}}},stop:function(b){if(this.options.sprite){if(b){this.streams[b.part].stop()}else{for(z in this.options.sprite){this.streams[z].stop()}}}else{this.streams[0].stop()}},pause:function(b){if(this.options.sprite){if(b){this.streams[b.part].pause()}else{for(z in this.options.sprite){this.streams[z].pause()}}}else{this.streams[0].pause()}},volume:function(b){if(b){if(v(b,this.options),this.options.sprite){if(this.options.part){(b=this.streams[this.options.part])&&b.setVolume(this.options)}else{for(z in this.options.sprite){(b=this.streams[z])&&b.setVolume(this.options)}}}else{(b=this.streams[0])&&b.setVolume(this.options)}}}};var t=function(d,c){this.alias=d.alias;this.name=d.name;this.sprite_part=c;this.buffer=d.buffer;this.start=d.start||0;this.end=d.end||this.buffer.duration;this.multiplay=d.multiplay||!1;this.volume=d.volume||1;this.scope=d.scope;this.ended_callback=d.ended_callback;this.setLoop(d);this.gain=this.source=null;this.paused=this.playing=!1;this.time_offset=this.time_played=this.time_ended=this.time_started=0};t.prototype={destroy:function(){this.stop();this.source=this.buffer=null;this.gain&&this.gain.disconnect();this.source&&this.source.disconnect();this.source=this.gain=null},setLoop:function(b){this.loop=!0===b.loop?9999999:"number"===typeof b.loop?+b.loop-1:!1},update:function(b){this.setLoop(b);"volume" in b&&(this.volume=b.volume)},play:function(b){b&&this.update(b);if(this.multiplay||!this.playing){this.gain=u.createGain(),this.source=u.createBufferSource(),this.source.buffer=this.buffer,this.source.connect(this.gain),this.gain.connect(u.destination),this.gain.gain.value=this.volume,this.source.onended=this.ended.bind(this),this._play()}},_play:function(){var d,c;this.paused?(d=this.start+this.time_offset,c=this.end-this.time_offset):(d=this.start,c=this.end);0>=c?this.clear():("function"===typeof this.source.start?this.source.start(0,d,c):this.source.noteOn(0,d,c),this.playing=!0,this.paused=!1,this.time_started=(new Date).valueOf())},stop:function(){this.playing&&this.source&&("function"===typeof this.source.stop?this.source.stop(0):this.source.noteOff(0));this.clear()},pause:function(){this.paused?this.play():this.playing&&(this.source&&this.source.stop(0),this.paused=!0)},ended:function(){this.playing=!1;this.time_ended=(new Date).valueOf();this.time_played=(this.time_ended-this.time_started)/1000;this.time_offset+=this.time_played;if(this.time_offset>=this.end||0.015>this.end-this.time_offset){this._ended(),this.clear(),this.loop&&(this.loop--,this.play())}},_ended:function(){var b={name:this.name,alias:this.alias,part:this.sprite_part,start:this.start,duration:this.end};this.ended_callback&&"function"===typeof this.ended_callback&&this.ended_callback.call(this.scope,b)},clear:function(){this.time_offset=this.time_played=0;this.playing=this.paused=!1},setVolume:function(b){this.volume=b.volume;this.gain&&(this.gain.gain.value=this.volume)}};u||(function(){var h=new Audio,c=h.canPlayType("audio/mpeg"),l=h.canPlayType("audio/ogg"),h=h.canPlayType('audio/mp4; codecs="mp4a.40.2"'),m,k;for(k=0;k<y.supported.length;k++){m=y.supported[k],c||"mp3"!==m||y.supported.splice(k,1),l||"ogg"!==m||y.supported.splice(k,1),h||"aac"!==m||y.supported.splice(k,1),h||"mp4"!==m||y.supported.splice(k,1)}}(),i.prototype={init:function(b){b&&v(b,this.options);this.inited=!0;this.options.preload&&this.load()},destroy:function(){var b;for(z in this.streams){(b=this.streams[z])&&b.destroy()}this.streams={};this.inited=this.loaded=!1},load:function(){var b;this.options.preload=!0;this.options._ready=this.ready;this.options._scope=this;if(this.options.sprite){for(z in this.options.sprite){b=this.options.sprite[z],this.options.start=b[0],this.options.end=b[1],this.streams[z]=new t(this.options,z)}}else{this.streams[0]=new t(this.options)}},ready:function(b){this.loaded||(this.loaded=!0,b={name:this.options.name,alias:this.options.alias,ext:this.options.supported[this.ext],duration:b},this.options.ready_callback&&"function"===typeof this.options.ready_callback&&this.options.ready_callback.call(this.options.scope,b),this.autoplay&&(this.autoplay=!1,this.play()))},play:function(b){if(this.inited){if(delete this.options.part,b&&v(b,this.options),console.log(1),this.loaded){if(this.options.sprite){if(this.options.part){this.streams[this.options.part].play(this.options)}else{for(z in this.options.sprite){this.streams[z].play(this.options)}}}else{this.streams[0].play(this.options)}}else{this.options.preload?this.autoplay=!0:(this.autoplay=!0,this.load())}}},stop:function(b){if(this.inited){if(this.options.sprite){if(b){this.streams[b.part].stop()}else{for(z in this.options.sprite){this.streams[z].stop()}}}else{this.streams[0].stop()}}},pause:function(b){if(this.inited){if(this.options.sprite){if(b){this.streams[b.part].pause()}else{for(z in this.options.sprite){this.streams[z].pause()}}}else{this.streams[0].pause()}}},volume:function(b){if(b){if(v(b,this.options),this.options.sprite){if(this.options.part){(b=this.streams[this.options.part])&&b.setVolume(this.options)}else{for(z in this.options.sprite){(b=this.streams[z])&&b.setVolume(this.options)}}}else{(b=this.streams[0])&&b.setVolume(this.options)}}}},t=function(d,c){this.name=d.name;this.alias=d.alias;this.sprite_part=c;this.multiplay=d.multiplay;this.volume=d.volume;this.preload=d.preload;this.path=y.path;this.start=d.start||0;this.end=d.end||0;this.scope=d.scope;this.ended_callback=d.ended_callback;this._scope=d._scope;this._ready=d._ready;this.setLoop(d);this.url=this.sound=null;this.loaded=!1;this.played_time=this.paused_time=this.start_time=0;this.init()},t.prototype={init:function(){this.sound=new Audio;this.sound.volume=this.volume;this.createUrl();this.sound.addEventListener("ended",this.ended.bind(this),!1);this.sound.addEventListener("canplaythrough",this.can_play_through.bind(this),!1);this.sound.addEventListener("timeupdate",this._update.bind(this),!1);this.load()},destroy:function(){this.stop();this.sound.removeEventListener("ended",this.ended.bind(this),!1);this.sound.removeEventListener("canplaythrough",this.can_play_through.bind(this),!1);this.sound.removeEventListener("timeupdate",this._update.bind(this),!1);this.sound=null;this.loaded=!1},createUrl:function(){var b=(new Date).valueOf();this.url=this.path+encodeURIComponent(this.name)+"."+y.supported[0]+"?"+b},can_play_through:function(){this.preload&&this.ready()},load:function(){this.sound.src=this.url;this.sound.preload=this.preload?"auto":"none";this.preload&&this.sound.load()},setLoop:function(b){this.loop=!0===b.loop?9999999:"number"===typeof b.loop?+b.loop-1:!1},update:function(b){this.setLoop(b);"volume" in b&&(this.volume=b.volume)},ready:function(){!this.loaded&&this.sound&&(this.loaded=!0,this._ready.call(this._scope,this.sound.duration),this.end||(this.end=this.sound.duration))},play:function(b){b&&this.update(b);!this.multiplay&&this.playing||this._play()},_play:function(){if(this.paused){this.paused=!1}else{try{this.sound.currentTime=this.start}catch(b){}}this.playing=!0;this.start_time=(new Date).valueOf();this.sound.volume=this.volume;this.sound.play()},stop:function(){if(this.playing){this.paused=this.playing=!1;this.sound.pause();this.clear();try{this.sound.currentTime=this.start}catch(b){}}},pause:function(){this.paused?this._play():(this.playing=!1,this.paused=!0,this.sound.pause(),this.paused_time=(new Date).valueOf(),this.played_time+=this.paused_time-this.start_time)},_update:function(){this.start_time&&(this.played_time+((new Date).valueOf()-this.start_time))/1000>=this.end&&this.playing&&(this.stop(),this._ended())},ended:function(){this.playing&&(this.stop(),this._ended())},_ended:function(){this.playing=!1;var b={name:this.name,alias:this.alias,part:this.sprite_part,start:this.start,duration:this.end};this.ended_callback&&"function"===typeof this.ended_callback&&this.ended_callback.call(this.scope,b);this.loop&&setTimeout(this.looper.bind(this),15)},looper:function(){this.loop--;this.play()},clear:function(){this.paused_time=this.played_time=this.start_time=0},setVolume:function(b){this.volume=b.volume;this.sound&&(this.sound.volume=this.volume)}})}}})(window,navigator,window.jQuery||window.$);